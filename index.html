<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Contacto</title>
    <meta name="description" content="Formulario de contacto simple en GitHub Pages usando Formspree" />
    <style>
      :root { --bg:#0b1220; --card:#121a2b; --muted:#8aa0c8; --text:#e8eefc; --accent:#7aa2ff; --accent2:#5ad1a6; }
      *{box-sizing:border-box}
      body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;color:var(--text);background:radial-gradient(1200px 800px at 20% -10%,#1b2540,transparent),
            radial-gradient(1000px 900px at 120% 10%,#18223a,transparent),var(--bg);}
      .wrap{max-width:880px;margin:5vh auto;padding:24px}
      .card{background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));
            border:1px solid rgba(255,255,255,.08);backdrop-filter: blur(6px);
            border-radius:20px; padding:28px; box-shadow:0 20px 50px rgba(0,0,0,.35)}
      h1{font-size:clamp(1.6rem,2.2vw,2.2rem);margin:0 0 4px}
      p.lead{color:var(--muted);margin-top:0}
      form{display:grid;gap:16px;margin-top:12px}
      .row{display:grid;gap:16px;grid-template-columns:1fr}
      @media (min-width:700px){ .row{grid-template-columns:1fr 1fr} }
      label{font-weight:600; font-size:.95rem}
      input, textarea, select{width:100%;padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.15);
        background:rgba(9,14,25,.7); color:var(--text); outline:none; transition:border-color .2s, box-shadow .2s}
      input:focus, textarea:focus, select:focus{border-color:var(--accent); box-shadow:0 0 0 3px rgba(122,162,255,.25)}
      textarea{min-height:140px; resize:vertical}
      .hint{color:var(--muted);font-size:.85rem}
      .actions{display:flex;gap:12px;align-items:center;justify-content:flex-start;margin-top:6px}
      button{appearance:none;border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer}
      .btn-primary{background:linear-gradient(135deg,var(--accent),#9fb5ff); color:#0b1220}
      .btn-ghost{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,.15)}
      .success, .error{border-radius:14px;padding:14px 16px}
      .success{background:rgba(90,209,166,.15); border:1px solid rgba(90,209,166,.35)}
      .error{background:rgba(255,110,110,.1); border:1px solid rgba(255,110,110,.35)}
      .hidden{display:none}
      .divider{height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.15),transparent);margin:6px 0 2px}
      .required{color:#ff9b9b}
      .brand{display:flex;align-items:center;gap:10px;margin-bottom:10px}
      .brand-badge{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--accent2),var(--accent));display:grid;place-items:center;color:#0b1220;font-weight:900}
      footer{opacity:.7;font-size:.85rem;margin-top:18px}
      /* === Mejoras visuales de validación === */
      input:required:invalid, textarea:required:invalid, select:required:invalid { border-color:#ff7b7b; box-shadow:0 0 0 3px rgba(255,123,123,.15); }
      input:required:valid, textarea:required:valid, select:required:valid { border-color:rgba(90,209,166,.55); }
      .shake { animation: shake .3s linear 0s 1; }
      @keyframes shake { 0%{transform:translateX(0)} 25%{transform:translateX(-4px)} 50%{transform:translateX(4px)} 75%{transform:translateX(-4px)} 100%{transform:translateX(0)} }
    </style>
  </head>
  <body>
    <main class="wrap">
      <section class="card">
        <div class="brand">
          <div class="brand-badge">F</div>
          <div>
            <h1>Formulario de contacto</h1>
            <p class="lead">Hospedado en <strong>GitHub Pages</strong> y procesado por <strong>Formspree</strong>.</p>
          </div>
        </div>

        <div id="msg-success" class="success hidden" role="status">¡Gracias! Tu mensaje fue enviado correctamente.</div>
        <div id="msg-error" class="error hidden" role="alert">Ocurrió un error al enviar. Intenta nuevamente.</div>

        <div class="divider"></div>

        <!--
          Para usar Formspree:
          1) Crea una cuenta y un formulario. Obtendrás un endpoint tipo https://formspree.io/f/XYZabcd
          2) Reemplaza el valor de ACTION abajo con tu endpoint.
          3) (Opcional) Agrega un _next con URL de "gracias" si quieres redirigir tras el envío (cuando no uses AJAX).
        -->
        <form id="contact-form" action="https://formspree.io/f/xnngaben" method="POST">
          <div class="row">
            <div>
              <label for="nombre">Nombre <span class="required">*</span></label>
              <input id="nombre" name="nombre" type="text" required autocomplete="name" />
            </div>
            <div>
              <label for="email">Correo <span class="required">*</span></label>
              <input id="email" name="email" type="email" required autocomplete="email" />
            </div>
          </div>

          <div>
            <label for="asunto">Asunto</label>
            <input id="asunto" name="asunto" type="text" required />
          </div>

          <div>
            <label for="mensaje">Mensaje <span class="required">*</span></label>
            <textarea id="mensaje" name="mensaje" required placeholder="Cuéntame en qué te puedo ayudar…"></textarea>
          </div>

          <!-- Honeypot anti-spam sugerido por Formspree -->
          <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off" />

          <!-- Redirección opcional SIN usar AJAX -->
          <!-- <input type="hidden" name="_next" value="https://tuusuario.github.io/tu-repo/gracias.html"> -->

          <!-- ➕ Preguntas adicionales para adopción -->
          <fieldset style="border:1px solid rgba(255,255,255,.12);border-radius:12px;padding:12px 14px">
            <legend style="padding:0 6px;color:var(--muted)">Cuestionario de adopción</legend>

            <div>
              <label>¿Su vivienda es propia o arrendada? <span class="required">*</span></label>
              <div style="display:flex;gap:14px;margin-top:6px">
                <label><input type="radio" name="vivienda" value="propia" required> Propia</label>
                <label><input type="radio" name="vivienda" value="arrendada" required> Arrendada</label>
              </div>
              <p class="hint">Debe ser <strong>propia</strong> para continuar con la adopción.</p>
            </div>

            <div class="row">
              <div>
                <label for="personas_hogar">¿Cuántas personas viven en el hogar? <span class="required">*</span></label>
                <input id="personas_hogar" name="personas_hogar" type="number" min="1" step="1" required />
              </div>
              <div>
                <label>¿Todas están de acuerdo con la adopción? <span class="required">*</span></label>
                <div style="display:flex;gap:14px;margin-top:6px">
                  <label><input type="radio" name="acuerdo_total" value="si" required> Sí</label>
                  <label><input type="radio" name="acuerdo_total" value="no" required> No</label>
                </div>
              </div>
            </div>

            <div>
              <label for="lugar_vivir">¿Dónde vivirá principalmente la mascota? <span class="required">*</span></label>
              <select id="lugar_vivir" name="lugar_vivir" required>
                <option value="" selected disabled>Selecciona una opción</option>
                <option>Dentro de la casa</option>
                <option>Fuera</option>
                <option>Ambos</option>
              </select>
            </div>

            <div>
              <label for="acompanamiento">Durante el día, ¿estará acompañada o pasará varias horas sola? <span class="required">*</span></label>
              <select id="acompanamiento" name="acompanamiento" required>
                <option value="" selected disabled>Selecciona una opción</option>
                <option>Acompañada la mayor parte del día</option>
                <option>Estará sola varias horas</option>
                <option>Mixto (algunas horas sola)</option>
              </select>
            </div>

            <div>
              <label>¿Podrá garantizar paseos diarios? <span class="required">*</span></label>
              <div style="display:flex;gap:14px;margin-top:6px;align-items:center">
                <label><input type="radio" name="paseos_diarios" value="si" required> Sí</label>
                <label><input type="radio" name="paseos_diarios" value="no" required> No</label>
                <label id="cuantos_wrap" class="hidden" style="margin-left:10px">
                  ¿Cuántos aprox.? <input id="paseos_cantidad" name="paseos_cantidad" type="number" min="1" step="1" style="width:110px">
                </label>
              </div>
            </div>

            <div>
              <label for="otras_mascotas">¿Tiene actualmente otras mascotas en el hogar? ¿Cómo describiría su carácter?</label>
              <textarea id="otras_mascotas" name="otras_mascotas" required placeholder="Ej.: 1 perro y 1 gato; carácter: sociables, tranquilos, etc."></textarea>
            </div>

            <div>
              <label for="responsable_separacion">En caso de separación o divorcio, ¿quién asumiría la responsabilidad del cuidado?</label>
              <input id="responsable_separacion" name="responsable_separacion" type="text" required placeholder="Nombre / relación" />
            </div>

            <div>
              <label>¿Cuenta con medios económicos para alimentación, controles y emergencias? <span class="required">*</span></label>
              <div style="display:flex;gap:14px;margin-top:6px">
                <label><input type="radio" name="medios_economicos" value="si" required> Sí</label>
                <label><input type="radio" name="medios_economicos" value="no" required> No</label>
              </div>
            </div>

            <div>
              <label for="planes_vacaciones">En vacaciones o viajes, ¿qué planes tendría para el cuidado?</label>
              <textarea id="planes_vacaciones" name="planes_vacaciones" required placeholder="Encargado/a de confianza, residencia temporal, llevarla, etc."></textarea>
            </div>

            <div>
              <label>¿Su patio o espacio exterior está completamente cerrado y seguro? <span class="required">*</span></label>
              <div style="display:flex;gap:14px;margin-top:6px">
                <label><input type="radio" name="patio_cerrado" value="si" required> Sí</label>
                <label><input type="radio" name="patio_cerrado" value="no" required> No</label>
              </div>
            </div>
          </fieldset>

          <div class="actions">
            <button class="btn-primary" type="submit">Enviar</button>
            <button class="btn-ghost" type="reset">Limpiar</button>
            <span class="hint">Campos marcados con <span class="required">*</span> son obligatorios.</span>
          </div>
        </form>

        <footer>
          <p>Consejo: en el panel de Formspree puedes activar notificaciones por email y ver los envíos.</p>
        </footer>
      </section>
    </main>

    <script>
      // Envío con fetch para permanecer en la misma página.
      // Alternativamente, elimina este script para usar POST tradicional + _next.
      const form = document.getElementById('contact-form');
      const success = document.getElementById('msg-success');
      const error = document.getElementById('msg-error');

      async function handleSubmit(e){
        e.preventDefault();
        success.classList.add('hidden');
        error.classList.add('hidden');

        const data = new FormData(form);
        try{
          const res = await fetch(form.action, {
            method: 'POST',
            body: data,
            headers: { 'Accept': 'application/json' }
          });
          if(res.ok){
            form.reset();
            success.classList.remove('hidden');
            success.scrollIntoView({behavior:'smooth', block:'center'});
          } else {
            // Si Formspree devuelve errores de validación, intenta leerlos
            const err = await res.json().catch(()=>({}));
            console.error(err);
            error.classList.remove('hidden');
            error.scrollIntoView({behavior:'smooth', block:'center'});
          }
        }catch(err){
          console.error(err);
          error.classList.remove('hidden');
          error.scrollIntoView({behavior:'smooth', block:'center'});
        }
      }

      // Lógica condicional del cuestionario
      const viviendaRadios = document.querySelectorAll('input[name="vivienda"]');
      const paseosRadios = document.querySelectorAll('input[name="paseos_diarios"]');
      const cuantosWrap = document.getElementById('cuantos_wrap');
      const paseosCantidad = document.getElementById('paseos_cantidad');

      paseosRadios.forEach(r => r.addEventListener('change', () => {
        if (r.checked && r.value === 'si') {
          cuantosWrap.classList.remove('hidden');
          paseosCantidad.setAttribute('required','required');
        } else if (r.checked && r.value === 'no') {
          cuantosWrap.classList.add('hidden');
          paseosCantidad.removeAttribute('required');
          paseosCantidad.value = '';
        }
      }));

      function viviendaEsPropia(){
        const sel = document.querySelector('input[name="vivienda"]:checked');
        return sel && sel.value === 'propia';
      }

      form.addEventListener('submit', (e) => {
        // 1) Validación nativa HTML5
        if (!form.checkValidity()) {
          e.preventDefault();
          // Muestra los tooltips nativos
          form.reportValidity();
          // Enfoca y anima el primer campo inválido
          const firstInvalid = form.querySelector(':invalid');
          if (firstInvalid) {
            firstInvalid.scrollIntoView({behavior:'smooth', block:'center'});
            firstInvalid.classList.add('shake');
            setTimeout(()=>firstInvalid.classList.remove('shake'), 400);
          }
          return;
        }
        // 2) Regla de negocio: vivienda debe ser propia
        if (!viviendaEsPropia()) {
          e.preventDefault();
          error.textContent = 'Para continuar con la adopción, la vivienda debe ser propia.';
          error.classList.remove('hidden');
          error.scrollIntoView({behavior:'smooth', block:'center'});
          return;
        }
      });

      form.addEventListener('submit', handleSubmit);
    </script>
  </body>
</html>
